<svg width="800" height="900" xmlns="http://www.w3.org/2000/svg" style="background-color: #ffffff; font-family: 'Segoe UI', Roboto, sans-serif;">
  <!-- Definitions -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#34495e" />
    </marker>
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-color="#000000" flood-opacity="0.2"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="400" y="40" font-size="24" font-weight="bold" text-anchor="middle" fill="#2c3e50">Street English App - 系统工作流程图</text>

  <!-- Legend -->
  <g transform="translate(600, 60)">
    <rect x="0" y="0" width="180" height="90" rx="5" fill="#f8f9fa" stroke="#bdc3c7" />
    <text x="10" y="20" font-size="12" font-weight="bold" fill="#7f8c8d">图例:</text>
    
    <circle cx="20" cy="35" r="5" fill="#2ecc71" />
    <text x="35" y="40" font-size="12" fill="#34495e">用户动作 (User Action)</text>
    
    <rect x="15" y="50" width="10" height="10" fill="#3498db" />
    <text x="35" y="60" font-size="12" fill="#34495e">系统逻辑 (System Logic)</text>
    
    <rect x="15" y="70" width="10" height="10" fill="#e67e22" />
    <text x="35" y="80" font-size="12" fill="#34495e">UI 更新 (UI Update)</text>
  </g>

  <!-- 1. Initialization Phase -->
  <g transform="translate(300, 80)">
    <rect x="0" y="0" width="200" height="40" rx="20" fill="#95a5a6" filter="url(#shadow)" />
    <text x="100" y="25" font-size="14" fill="white" text-anchor="middle" font-weight="bold">Start / Page Load</text>
  </g>
  
  <line x1="400" y1="120" x2="400" y2="150" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />

  <g transform="translate(280, 150)">
    <rect x="0" y="0" width="240" height="50" rx="5" fill="#3498db" filter="url(#shadow)" />
    <text x="120" y="20" font-size="14" fill="white" text-anchor="middle" font-weight="bold">init()</text>
    <text x="120" y="40" font-size="12" fill="#ecf0f1" text-anchor="middle">Load Data -> Shuffle -> Render</text>
  </g>

  <line x1="400" y1="200" x2="400" y2="240" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />

  <!-- 2. Main Interaction Loop (User Actions) -->
  <!-- Splitter line -->
  <line x1="150" y1="240" x2="650" y2="240" stroke="#34495e" stroke-width="2" />
  <line x1="150" y1="240" x2="150" y2="270" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="400" y1="240" x2="400" y2="270" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="650" y1="240" x2="650" y2="270" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />

  <!-- Branch 1: Click Card (Translation) -->
  <g transform="translate(50, 270)">
    <circle cx="100" cy="30" r="30" fill="#2ecc71" filter="url(#shadow)" />
    <text x="100" y="35" font-size="12" fill="white" text-anchor="middle" font-weight="bold">点击卡片</text>
    
    <line x1="100" y1="60" x2="100" y2="90" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="20" y="90" width="160" height="50" rx="5" fill="#3498db" filter="url(#shadow)" />
    <text x="100" y="110" font-size="12" fill="white" text-anchor="middle">Monster Interaction</text>
    <text x="100" y="130" font-size="10" fill="#ecf0f1" text-anchor="middle">Spit Animation</text>
    
    <line x1="100" y1="140" x2="100" y2="170" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="20" y="170" width="160" height="40" rx="5" fill="#e67e22" filter="url(#shadow)" />
    <text x="100" y="195" font-size="12" fill="white" text-anchor="middle">显示/隐藏 中文翻译</text>
  </g>

  <!-- Branch 2: Drag & Drop (Sentence/Review) -->
  <g transform="translate(300, 270)">
    <circle cx="100" cy="30" r="30" fill="#2ecc71" filter="url(#shadow)" />
    <text x="100" y="35" font-size="12" fill="white" text-anchor="middle" font-weight="bold">拖拽卡片</text>
    
    <line x1="100" y1="60" x2="100" y2="90" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <!-- Decision Diamond -->
    <path d="M100,90 L160,120 L100,150 L40,120 Z" fill="#95a5a6" stroke="#7f8c8d" />
    <text x="100" y="125" font-size="12" fill="white" text-anchor="middle">目标区域?</text>
    
    <!-- Left: Sentence Zone -->
    <line x1="40" y1="120" x2="20" y2="120" stroke="#34495e" stroke-width="2" />
    <line x1="20" y1="120" x2="20" y2="180" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="-40" y="180" width="120" height="40" rx="5" fill="#3498db" filter="url(#shadow)" />
    <text x="20" y="205" font-size="12" fill="white" text-anchor="middle">Generate Sentence</text>
    
    <line x1="20" y1="220" x2="20" y2="250" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="-40" y="250" width="120" height="40" rx="5" fill="#e67e22" filter="url(#shadow)" />
    <text x="20" y="275" font-size="12" fill="white" text-anchor="middle">UI: 显示例句</text>

    <!-- Right: Review/Completed -->
    <line x1="160" y1="120" x2="180" y2="120" stroke="#34495e" stroke-width="2" />
    <line x1="180" y1="120" x2="180" y2="180" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="120" y="180" width="120" height="40" rx="5" fill="#3498db" filter="url(#shadow)" />
    <text x="180" y="205" font-size="12" fill="white" text-anchor="middle">Move Card Data</text>
    
    <line x1="180" y1="220" x2="180" y2="250" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="120" y="250" width="120" height="40" rx="5" fill="#e67e22" filter="url(#shadow)" />
    <text x="180" y="275" font-size="12" fill="white" text-anchor="middle">UI: 移动卡片</text>
  </g>

  <!-- Branch 3: Audio / Search / Shuffle -->
  <g transform="translate(550, 270)">
    <circle cx="100" cy="30" r="30" fill="#2ecc71" filter="url(#shadow)" />
    <text x="100" y="28" font-size="12" fill="white" text-anchor="middle" font-weight="bold">点击音频</text>
    <text x="100" y="42" font-size="12" fill="white" text-anchor="middle" font-weight="bold">/ 搜索</text>
    
    <line x1="100" y1="60" x2="100" y2="90" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="20" y="90" width="160" height="50" rx="5" fill="#3498db" filter="url(#shadow)" />
    <text x="100" y="110" font-size="12" fill="white" text-anchor="middle">API 调用</text>
    <text x="100" y="130" font-size="10" fill="#ecf0f1" text-anchor="middle">Web Speech / Search API</text>
    
    <line x1="100" y1="140" x2="100" y2="170" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />
    
    <rect x="20" y="170" width="160" height="40" rx="5" fill="#e67e22" filter="url(#shadow)" />
    <text x="100" y="195" font-size="12" fill="white" text-anchor="middle">播放声音 / 显示结果</text>
  </g>

  <!-- Convergence -->
  <line x1="100" y1="600" x2="700" y2="600" stroke="#34495e" stroke-width="2" />
  <!-- Connecting lines from branches to convergence line -->
  <line x1="150" y1="480" x2="150" y2="600" stroke="#34495e" stroke-width="2" /> <!-- Branch 1 -->
  <line x1="320" y1="565" x2="320" y2="600" stroke="#34495e" stroke-width="2" /> <!-- Branch 2 Left -->
  <line x1="480" y1="565" x2="480" y2="600" stroke="#34495e" stroke-width="2" /> <!-- Branch 2 Right -->
  <line x1="650" y1="480" x2="650" y2="600" stroke="#34495e" stroke-width="2" /> <!-- Branch 3 -->

  <line x1="400" y1="600" x2="400" y2="650" stroke="#34495e" stroke-width="2" marker-end="url(#arrow)" />

  <!-- Loop Back / End -->
  <g transform="translate(300, 650)">
    <rect x="0" y="0" width="200" height="50" rx="5" fill="#95a5a6" filter="url(#shadow)" />
    <text x="100" y="20" font-size="14" fill="white" text-anchor="middle" font-weight="bold">Wait for Action</text>
    <text x="100" y="40" font-size="12" fill="#ecf0f1" text-anchor="middle">(Event Loop)</text>
  </g>

  <!-- Connect back to top (Conceptual) -->
  <path d="M500,675 L750,675 L750,240 L650,240" fill="none" stroke="#7f8c8d" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrow)" />
  <text x="760" y="450" font-size="12" fill="#7f8c8d" transform="rotate(90 760,450)">Ready for next interaction</text>

  <!-- Notes -->
  <text x="400" y="750" font-size="12" fill="#7f8c8d" text-anchor="middle">Process Flow Diagram - Generated for Street English App</text>
</svg>